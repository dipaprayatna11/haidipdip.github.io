<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" />
    <title>Data Google Sheets</title>
  </head>
  <body>
    <div class="container">
      <h1 class="text-center my-5">Data Google Sheets</h1>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Nama Lengkap</th>
            <th>Tempat Lahir</th>
            <th>Tanggal Lahir</th>
            <th>Jenis Kelamin</th>
            <th>Alamat Asal</th>
            <th>Asal Sekolah</th>
          </tr>
        </thead>
        <tbody id="data-table">
          <!-- Data akan dimuat di sini -->
        </tbody>
      </table>
    </div>
    <script>
      // URL API Google Sheets
      const API_URL = "https://script.google.com/macros/s/AKfycbxsEC8Hfc-uCNsZ45-6-c3_GVbpzrTb89CPkAS30eXEo0nLVMFeh2_18S6i4V3gi9yTDQ/exec";

      // Fungsi untuk memuat data dari API
      const loadData = async () => {
        try {
          const response = await fetch(API_URL);
          const data = await response.json();
          const rows = data.feed.entry;
          let html = "";

          // Loop untuk setiap baris data
          rows.forEach((row) => {
            const namalengkap = row.gsx$namalengkap.$t;
            const tempatlahir = row.gsx$tempatlahir.$t;
            const tanggallahir = row.gsx$tanggallahir.$t;
            const jeniskelamin = row.gsx$jeniskelamin.$t;
            const alamatasal = row.gsx$alamatasal.$t;
            const asalsekolah = row.gsx$asalsekolah.$t;
            html += `
            <tr>
              <td>${namalengkap}</td>
              <td>${tempatlahir}</td>
              <td>${tanggallahir}</td>
              <td>${jeniskelamin}</td>
              <td>${alamatasal}</td>
              <td>${asalsekolah}</td>
            </tr>
          `;
          });

          // Tampilkan data di tabel
          document.querySelector("#data-table").innerHTML = html;
        } catch (error) {
          console.error(error);
        }
      };

      // Muat data ketika halaman web dimuat
      document.addEventListener("DOMContentLoaded", loadData);
    </script>
  </body>
</html>
